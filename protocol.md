## 森林防火通信协议V1.0

### 概述

>任务计算机与服务端通信传输文本类数据使用该协议进行传输

>客户端与服务端通信（TCP/UDP）均使用该协议

### 协议说明

##### 多字节传输时，字节序采用网络字节序即大端,例如整形数字100转换成字节表示为0x00 0x00 0x00 0x64

##### 心跳机制:  

###### 由客户端主动发送心跳包到服务器，服务器接收到客户端心跳后立即回复心跳回复包，当客户端连续三个心跳包未收到回复时认定连接失效，关闭当前连接并重新发起连接到服务器（重新发起的连接需要重新登录）。

###### 心跳发起频率：暂定为 5秒

### 内部消息协议格式(发送与接收均使用此协议格式)

|字节序号|帧内容|字节数|备注|
|:---|:---|:---|:---|
|1~2|数据包头|2|0x8a 0x91(暂定)|
|3|协议版本|1|当前为0x01|
|4|业务类型|1|  1 盒子发向客户端 , 2 客户端发向盒子 , 3 发向服务端 |
|5~6|数据包类型标识|2|表示不同种类数据包|
|7~10|任务计算机ID|4|任务计算机唯一标识|
|11~22|预留字节|12|此次飞行任务的ID|
|23|状态码|1|有交互状态的数据包使用，0失败，1成功|
|24～25|数据区长度|2|数据长度(包括数据区和校验码)|
|26~n|数据区|长度不定|根据数据包类型不同携带不同有效数据|
|(n+1)~(n+4)|校验码|4|校验码，校验数据是否误码（暂时填0x00 0x00 0x00 0x00）|


### 数据包类型标识定义

#### 通用数据类型

|数值|含义|使用场景|备注|
|:---|:---|:---|:---|
|1321|心跳|客户端主动向服务端发起心跳|-|
|1322|心跳回复|服务端接收到客户端心跳后，回复数据包|-|